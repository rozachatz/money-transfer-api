CREATE TABLE ACCOUNTS (
    ACCOUNT_ID UUID PRIMARY KEY,
    OWNER_NAME VARCHAR(20),
    BALANCE DECIMAL(19, 4),
    CURRENCY VARCHAR(255),
    CREATED_AT TIMESTAMP,
    VERSION INT
);

CREATE TABLE TRANSACTIONS (
    TRANSACTION_ID UUID PRIMARY KEY,
    SOURCE_ACCOUNT_ID UUID,
    TARGET_ACCOUNT_ID UUID,
    AMOUNT DECIMAL(19, 4),
    CURRENCY VARCHAR(255),
    TRANSACTION_STATUS VARCHAR(255),
    MESSAGE VARCHAR(255),
    HASHED_PAYLOAD INT,
    HTTP_STATUS VARCHAR(10)
);

ALTER TABLE TRANSACTIONS
ADD CONSTRAINT FK_source_account
FOREIGN KEY (SOURCE_ACCOUNT_ID)
REFERENCES ACCOUNTS(ACCOUNT_ID);

ALTER TABLE TRANSACTIONS
ADD CONSTRAINT FK_target_account
FOREIGN KEY (TARGET_ACCOUNT_ID)
REFERENCES ACCOUNTS(ACCOUNT_ID);

CREATE TABLE REQUESTS (
    REQUEST_ID UUID PRIMARY KEY,
    REQUEST_STATUS VARCHAR(10),
    TRANSACTION_ID UUID,
    SOURCE_ACCOUNT_ID UUID,
    TARGET_ACCOUNT_ID UUID,
    AMOUNT DECIMAL(19, 4)
);

ALTER TABLE REQUESTS
ADD CONSTRAINT FK_transaction
FOREIGN KEY (TRANSACTION_ID)
REFERENCES TRANSACTIONS(TRANSACTION_ID);


-- Insert new account 1
INSERT INTO accounts (ACCOUNT_ID, OWNER_NAME, BALANCE, CURRENCY, VERSION)
VALUES ('e4c6f84c-8f92-4f2b-90bb-4352e9379bca', 'Bill Gates', 1000.00, 'EUR', 1);

-- Insert new account 2
INSERT INTO accounts (ACCOUNT_ID, OWNER_NAME, BALANCE, CURRENCY, VERSION)
VALUES ('6a7d71f0-6f12-45a6-91a1-198272a09fe8', 'Elon Musk', 750.50, 'EUR', 1);

-- Insert new account 3
INSERT INTO accounts (ACCOUNT_ID, OWNER_NAME, BALANCE, CURRENCY, VERSION)
VALUES ('e4c6f84c-8f92-4f2b-90bb-4352e9379bcb', 'Onasis', 100.00, 'USD', 1);

-- Insert new account 4
INSERT INTO accounts (ACCOUNT_ID, OWNER_NAME, BALANCE, CURRENCY, VERSION)
VALUES ('6a7d71f0-6f12-45a6-91a1-198272a09fe9','Bakogiannis', 75.50, 'CAD', 1);

-- Insert default account
INSERT INTO accounts (ACCOUNT_ID, OWNER_NAME, BALANCE, CURRENCY, VERSION)
VALUES ('00000000-0000-0000-0000-000000000000', 'Unnamed' ,0.0, 'NOT_DEFINED', 1);
